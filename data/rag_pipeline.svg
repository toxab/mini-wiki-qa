<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.42.4 (0)
 -->
<!-- Pages: 1 -->
<svg width="787pt" height="1592pt"
 viewBox="0.00 0.00 378.00 764.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(2.08 2.08) rotate(0) translate(36 728)">
<polygon fill="white" stroke="transparent" points="-36,36 -36,-728 342,-728 342,36 -36,36"/>
<text text-anchor="middle" x="153" y="-678.4" font-family="Arial" font-size="12.00">RAG Pipeline with Safety Layers</text>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
<path fill="#e1f5e1" stroke="black" d="M231,-671C231,-671 75,-671 75,-671 69,-671 63,-665 63,-659 63,-659 63,-625 63,-625 63,-619 69,-613 75,-613 75,-613 231,-613 231,-613 237,-613 243,-619 243,-625 243,-625 243,-659 243,-659 243,-665 237,-671 231,-671"/>
<text text-anchor="middle" x="153" y="-639.2" font-family="Arial" font-size="11.00">User Query</text>
</g>
<!-- injection -->
<g id="node2" class="node">
<title>injection</title>
<path fill="#ffe6e6" stroke="black" d="M231,-576C231,-576 75,-576 75,-576 69,-576 63,-570 63,-564 63,-564 63,-530 63,-530 63,-524 69,-518 75,-518 75,-518 231,-518 231,-518 237,-518 243,-524 243,-530 243,-530 243,-564 243,-564 243,-570 237,-576 231,-576"/>
<text text-anchor="middle" x="153" y="-550.2" font-family="Arial" font-size="11.00">Injection Guard</text>
<text text-anchor="middle" x="153" y="-538.2" font-family="Arial" font-size="11.00">(Security Check)</text>
</g>
<!-- start&#45;&gt;injection -->
<g id="edge1" class="edge">
<title>start&#45;&gt;injection</title>
<path fill="none" stroke="#333333" stroke-width="2" d="M153,-612.84C153,-604.47 153,-595.15 153,-586.24"/>
<polygon fill="#333333" stroke="#333333" stroke-width="2" points="156.5,-586.06 153,-576.06 149.5,-586.06 156.5,-586.06"/>
</g>
<!-- retrieve -->
<g id="node3" class="node">
<title>retrieve</title>
<path fill="#e6f3ff" stroke="black" d="M168,-467C168,-467 12,-467 12,-467 6,-467 0,-461 0,-455 0,-455 0,-421 0,-421 0,-415 6,-409 12,-409 12,-409 168,-409 168,-409 174,-409 180,-415 180,-421 180,-421 180,-455 180,-455 180,-461 174,-467 168,-467"/>
<text text-anchor="middle" x="90" y="-441.2" font-family="Arial" font-size="11.00">Retrieve</text>
<text text-anchor="middle" x="90" y="-429.2" font-family="Arial" font-size="11.00">(Semantic Search)</text>
</g>
<!-- injection&#45;&gt;retrieve -->
<g id="edge2" class="edge">
<title>injection&#45;&gt;retrieve</title>
<path fill="none" stroke="#4caf50" stroke-width="2" d="M113.9,-517.89C108.53,-512.5 103.62,-506.49 100,-500 96.1,-493.02 93.62,-484.93 92.07,-476.97"/>
<polygon fill="#4caf50" stroke="#4caf50" stroke-width="2" points="95.53,-476.42 90.56,-467.06 88.61,-477.47 95.53,-476.42"/>
<text text-anchor="middle" x="147" y="-488.8" font-family="Times,serif" font-size="14.00">is_safe=True</text>
</g>
<!-- end -->
<g id="node4" class="node">
<title>end</title>
<path fill="#e1f5e1" stroke="black" d="M227,-58C227,-58 71,-58 71,-58 65,-58 59,-52 59,-46 59,-46 59,-12 59,-12 59,-6 65,0 71,0 71,0 227,0 227,0 233,0 239,-6 239,-12 239,-12 239,-46 239,-46 239,-52 233,-58 227,-58"/>
<text text-anchor="middle" x="149" y="-26.2" font-family="Arial" font-size="11.00">Final Answer</text>
</g>
<!-- injection&#45;&gt;end -->
<g id="edge3" class="edge">
<title>injection&#45;&gt;end</title>
<path fill="none" stroke="#f44336" stroke-width="2" stroke-dasharray="5,2" d="M181.87,-517.96C186.46,-512.37 190.76,-506.27 194,-500 206.77,-475.29 208,-466.82 208,-439 208,-439 208,-439 208,-123 208,-102.16 197.3,-82.2 185.02,-66.16"/>
<polygon fill="#f44336" stroke="#f44336" stroke-width="2" points="187.52,-63.69 178.5,-58.14 182.09,-68.11 187.52,-63.69"/>
<text text-anchor="middle" x="257" y="-284.8" font-family="Times,serif" font-size="14.00">is_safe=False</text>
<text text-anchor="middle" x="257" y="-269.8" font-family="Times,serif" font-size="14.00">(blocked)</text>
</g>
<!-- rerank -->
<g id="node5" class="node">
<title>rerank</title>
<path fill="#fff5e6" stroke="black" d="M168,-372C168,-372 12,-372 12,-372 6,-372 0,-366 0,-360 0,-360 0,-326 0,-326 0,-320 6,-314 12,-314 12,-314 168,-314 168,-314 174,-314 180,-320 180,-326 180,-326 180,-360 180,-360 180,-366 174,-372 168,-372"/>
<text text-anchor="middle" x="90" y="-346.2" font-family="Arial" font-size="11.00">Rerank</text>
<text text-anchor="middle" x="90" y="-334.2" font-family="Arial" font-size="11.00">(Cross&#45;Encoder)</text>
</g>
<!-- retrieve&#45;&gt;rerank -->
<g id="edge4" class="edge">
<title>retrieve&#45;&gt;rerank</title>
<path fill="none" stroke="#2196f3" stroke-width="2" d="M90,-408.84C90,-400.47 90,-391.15 90,-382.24"/>
<polygon fill="#2196f3" stroke="#2196f3" stroke-width="2" points="93.5,-382.06 90,-372.06 86.5,-382.06 93.5,-382.06"/>
</g>
<!-- generate -->
<g id="node6" class="node">
<title>generate</title>
<path fill="#f0e6ff" stroke="black" d="M168,-248C168,-248 12,-248 12,-248 6,-248 0,-242 0,-236 0,-236 0,-202 0,-202 0,-196 6,-190 12,-190 12,-190 168,-190 168,-190 174,-190 180,-196 180,-202 180,-202 180,-236 180,-236 180,-242 174,-248 168,-248"/>
<text text-anchor="middle" x="90" y="-222.2" font-family="Arial" font-size="11.00">Generate</text>
<text text-anchor="middle" x="90" y="-210.2" font-family="Arial" font-size="11.00">(LLM Answer)</text>
</g>
<!-- rerank&#45;&gt;generate -->
<g id="edge5" class="edge">
<title>rerank&#45;&gt;generate</title>
<path fill="none" stroke="#ff9800" stroke-width="2" d="M90,-313.7C90,-297.23 90,-276.23 90,-258.29"/>
<polygon fill="#ff9800" stroke="#ff9800" stroke-width="2" points="93.5,-258.14 90,-248.14 86.5,-258.14 93.5,-258.14"/>
</g>
<!-- scrubber -->
<g id="node7" class="node">
<title>scrubber</title>
<path fill="#ffe6f0" stroke="black" d="M168,-153C168,-153 12,-153 12,-153 6,-153 0,-147 0,-141 0,-141 0,-107 0,-107 0,-101 6,-95 12,-95 12,-95 168,-95 168,-95 174,-95 180,-101 180,-107 180,-107 180,-141 180,-141 180,-147 174,-153 168,-153"/>
<text text-anchor="middle" x="90" y="-127.2" font-family="Arial" font-size="11.00">PII Scrubber</text>
<text text-anchor="middle" x="90" y="-115.2" font-family="Arial" font-size="11.00">(Privacy Filter)</text>
</g>
<!-- generate&#45;&gt;scrubber -->
<g id="edge6" class="edge">
<title>generate&#45;&gt;scrubber</title>
<path fill="none" stroke="#9c27b0" stroke-width="2" d="M90,-189.84C90,-181.47 90,-172.15 90,-163.24"/>
<polygon fill="#9c27b0" stroke="#9c27b0" stroke-width="2" points="93.5,-163.06 90,-153.06 86.5,-163.06 93.5,-163.06"/>
</g>
<!-- scrubber&#45;&gt;end -->
<g id="edge7" class="edge">
<title>scrubber&#45;&gt;end</title>
<path fill="none" stroke="#333333" stroke-width="2" d="M107.86,-94.84C113.47,-86.01 119.74,-76.13 125.66,-66.79"/>
<polygon fill="#333333" stroke="#333333" stroke-width="2" points="128.8,-68.38 131.2,-58.06 122.89,-64.63 128.8,-68.38"/>
</g>
</g>
</svg>
